name: Runner
on:
  push:
jobs:
  build:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        php: [8.0, 8.1, 8.2, 8.3, 8.4, 8.5]
    steps:
      - run: |
          wget https://github.com/ibmdb/db2drivers/raw/refs/heads/main/clidriver/v11.5.9/linuxx64_odbc_cli.tar.gz
          tar xf linuxx64_odbc_cli.tar.gz -C /tmp
          rm linuxx64_odbc_cli.tar.gz
      - uses: shivammathur/setup-php@v2    
        with:
          php-version: ${{ matrix.php }}
          extensions: ibm_db2
          coverage: pcov
          ini-values: zend.assertions=1
        env:
          IBM_DB2_CONFIGURE_OPTS: --with-IBM_DB2=/tmp/clidriver
          fail-fast: true
          debug: true
      - uses: mxschmitt/action-tmate@v3.22
        if: failure()
