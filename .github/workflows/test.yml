name: Main workflow
on: [push]
jobs:
  run:
    name: Run
    runs-on: ${{ matrix.os }}
    strategy:
      fail-fast: false
      matrix:
        os: [windows-2022]
    steps:
      - name: Install
        run: |
          Set-Location "C:\Program Files (x86)\Microsoft Visual Studio\Installer\"
          $installPath = "C:\Program Files\Microsoft Visual Studio\2022\Enterprise"
          $components = "--add Microsoft.VisualStudio.Component.VC.140 --add Microsoft.Component.VC.Runtime.UCRTSDK"
          $args = ('/c', "vs_installer.exe", 'modify', '--installPath', "`"$installPath`"", $components, '--quiet', '--norestart', '--nocache')
          $process = Start-Process -FilePath cmd.exe -ArgumentList $args -Wait -PassThru -WindowStyle Hidden
      - name: Test
        run: |
          $MSVCDirectory = vswhere -latest -find "VC\Tools\MSVC"
          Get-ChildItem $MSVCDirectory
          
