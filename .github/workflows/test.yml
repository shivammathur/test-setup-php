name: Test ext workflow
on: [push]
jobs:
  standard:
    strategy:
      matrix:
        include:
          - os: ubuntu-latest
            container: ubuntu:20.04
          - os: ubuntu-latest
            container: ubuntu:22.04
          - os: ubuntu-latest
            container: ubuntu:24.04
          - os: ubuntu-20.04
          - os: ubuntu-22.04
          - os: ubuntu-24.04
    runs-on: ${{ matrix.os }}
    container: ${{ matrix.container }}
    steps:
    - name: "Setup PHP extension caching"
      id: extcache
      uses: shivammathur/cache-extensions@develop
      with:
        php-version: 8.2
        extensions: mongodb,redis,sqlite3,gd,bcmath,pecl_http,memcached,grpc
        key: php-extensions-${{ runner.os }}-foov4

    - name: "Cache extensions"
      uses: actions/cache@v4
      with:
        path: ${{ steps.extcache.outputs.dir }}
        key: ${{ steps.extcache.outputs.key }}-foov4
        restore-keys: ${{ steps.extcache.outputs.key }}-foov4

    - name: "Setup PHP"
      uses: shivammathur/setup-php@develop
      with:
        php-version: 8.2
        extensions: mongodb,redis,sqlite3,gd,bcmath,pecl_http,memcached,grpc
        coverage: none
    - run: php -v && php -m    
